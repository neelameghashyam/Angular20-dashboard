<!-- aira-chatbot.html -->
<div class="fixed bottom-6 right-6 z-50">
  <!-- Floating Icon -->
 <button
  (click)="toggleChat()"
  *ngIf="!isOpen()"
>
  <img src="assets/icons/chat-bot.svg" alt="Chat Bot" class="w-12 h-12" />
</button>


  <!-- Chat Window -->
  <div
  *ngIf="isOpen()"
  class="bg-card text-card-foreground shadow-xl rounded-2xl flex flex-col overflow-hidden transition-all duration-300"
  [ngClass]="isExpanded() ? 'w-[800px] h-[500px]' : 'w-[350px] h-[500px]'"
>


    <!-- Header -->
    <div class="flex items-center justify-between p-3 border-b border-border bg-primary text-primary-foreground">
  <span class="font-semibold flex items-center gap-2">
    <img src="assets/icons/chat-bot.svg" alt="Chat Bot" class="w-8 h-8" />
    AIRA
  </span>
  <div class="flex gap-2">
    <button (click)="expandChat()" *ngIf="!isExpanded()" class="flex items-center">
      <span class="material-symbols-outlined">open_in_full</span>
    </button>
    <button (click)="collapseChat()" *ngIf="isExpanded()" class="flex items-center">
      <span class="material-symbols-outlined">hide</span>
    </button>
    <button (click)="toggleChat()" class="flex items-center">
      <span class="material-symbols-outlined">close</span>
    </button>
  </div>
</div>

    <!-- Messages -->
    <div class="flex-1 overflow-y-auto p-3 space-y-3 scrollbar-thin scrollbar-thumb-muted scrollbar-track-transparent">
      <div *ngFor="let msg of messages()">
        <div
          [ngClass]="msg.sender === 'user' ? 'text-right' : 'text-left'"
        >
          <div
            [ngClass]="msg.sender === 'user'
              ? 'inline-block bg-primary text-primary-foreground px-3 py-2 rounded-xl'
              : 'inline-block bg-muted text-muted-foreground px-3 py-2 rounded-xl'"
          >
            {{ msg.text }}
          </div>

          <!-- Tools -->
          <div *ngIf="msg.sender === 'bot' && msg.showTools" class="flex gap-2 mt-1 text-sm text-muted-foreground">
            <button (click)="copyMessage(msg.text)">📋</button>
            <button (click)="thumbsDown()">👎</button>
            <button>👍</button>
          </div>
        </div>
      </div>

      <!-- Typing dots -->
      <div *ngIf="awaitingResponse()" class="text-muted-foreground">Typing...</div>

      <!-- Feedback Box -->
      <div *ngIf="showFeedbackBox()" class="mt-3">
  <textarea
    [ngModel]="feedbackText()"
    (ngModelChange)="feedbackText.set($event)"
    placeholder="Please enter feedback..."
    class="w-full rounded-md border border-border p-2 text-sm"
  ></textarea>
  <button
    class="mt-1 bg-primary text-primary-foreground px-3 py-1 rounded-md"
    
    (click)="submitFeedback()"
  >
    Submit
  </button>
</div>
    </div>

    <!-- Input -->
 <div class="border-t border-border p-2 flex gap-2">
  <input
    type="text"
    placeholder="Type Here..."
    class="flex-1 rounded-md border border-border p-2 text-lg placeholder:text-lg"
    [ngModel]="userInput()"
    (ngModelChange)="userInput.set($event)"
    (keydown.enter)="sendMessage()"
  />

  <button
  class="p-0 m-0 border-none bg-transparent text-black"
  (click)="sendMessage()"
>
  <span class="material-symbols-outlined text-black">
    send
  </span>
</button>

</div>
  </div>
</div>
